@startuml
Driftctl -> Scanner: Resource()
Scanner -> Scanner: List Enumerators
loop
Scanner -> Enumerator: Enumerate()
Enumerator -> RemoteSDK: List resource
RemoteSDK --> Enumerator: []remoteRes
loop optionaly retrive resource needed attributes
Enumerator -> RemoteSDK: Retreive needed\nattributes
RemoteSDK --> Enumerator: Attrs
end
Enumerator --> Scanner: []Resources with\nlimited attributes
loop if deepmode
Scanner -> DetailsFetcher: ReadDetails(res)
DetailsFetcher -> TerraformProvider: ReadResource()
TerraformProvider --> DetailsFetcher: CTYValue
DetailsFetcher -> Deserializer: Deserialize()
Deserializer -> DetailsFetcher: Resource
DetailsFetcher -> Scanner: Resource with\nfull attributes
end
end
Scanner --> Driftctl: []Resource
@enduml
